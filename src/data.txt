CREATE DATABASE research_manage
  DEFAULT CHARACTER SET utf8mb4
  COLLATE utf8mb4_general_ci;


 USE research_manage;

CREATE TABLE sys_user (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  username VARCHAR(50) NOT NULL UNIQUE,
  password VARCHAR(100) NOT NULL,
  create_time DATETIME DEFAULT CURRENT_TIMESTAMP
);


CREATE TABLE researcher (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(50) NOT NULL,
  code VARCHAR(50) NOT NULL,
  college VARCHAR(100),
  title VARCHAR(50),
  phone VARCHAR(20),
	create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
  update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE project (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    code VARCHAR(100) NOT NULL,
    type VARCHAR(100),
    duration VARCHAR(50),
    leader VARCHAR(100),
    status int,
    description TEXT,
	create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
)

CREATE TABLE project_researcher (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    project_id BIGINT NOT NULL,
    researcher_id BIGINT NOT NULL,
    role VARCHAR(50),
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY uk_project_researcher (project_id, researcher_id)
);


CREATE TABLE paper (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255) NOT NULL,
    author VARCHAR(100) NOT NULL,
    journal VARCHAR(255),
    source VARCHAR(50),
    publish_date DATE,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
)



CREATE TABLE book (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255) NOT NULL,
    author VARCHAR(100) NOT NULL,
    publisher VARCHAR(255),
    publish_date DATE,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
)


CREATE TABLE award (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  target_type VARCHAR(20) NOT NULL COMMENT 'PROJECT / ACHIEVEMENT',
  target_id BIGINT NOT NULL COMMENT '关联对象ID',

  name VARCHAR(255) NOT NULL COMMENT '奖项名称',
  level VARCHAR(50) COMMENT '奖项级别',
  award_rank VARCHAR(50) COMMENT '奖项等级',
  organization VARCHAR(255) COMMENT '授奖单位',
  award_date DATE COMMENT '获奖时间',
  description VARCHAR(500) COMMENT '备注',
  create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
  update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);


CREATE TABLE sys_dict (
  id BIGINT PRIMARY KEY,
  dict_type VARCHAR(50) NOT NULL COMMENT '字典类型',
  dict_code VARCHAR(50) NOT NULL COMMENT '字典编码',
  dict_label VARCHAR(100) NOT NULL COMMENT '字典显示值',
  sort INT DEFAULT 0 COMMENT '排序',
  status TINYINT DEFAULT 1 COMMENT '状态 1启用 0停用',
  remark VARCHAR(255),
  create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
  update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);



INSERT INTO sys_dict (id, dict_type, dict_code, dict_label, sort)
VALUES
(20, 'AWARD_RANK', 'FIRST',  '一等奖', 1),
(21, 'AWARD_RANK', 'SECOND', '二等奖', 2),
(22, 'AWARD_RANK', 'THIRD',  '三等奖', 3);


INSERT INTO sys_dict (id, dict_type, dict_code, dict_label, sort)
VALUES
(10, 'AWARD_LEVEL', 'NATIONAL', '国家级', 1),
(11, 'AWARD_LEVEL', 'PROVINCE', '省部级', 2),
(12, 'AWARD_LEVEL', 'CITY',     '市级',   3),
(13, 'AWARD_LEVEL', 'SCHOOL',   '校级',   4);


INSERT INTO sys_dict (id, dict_type, dict_code, dict_label, sort)
VALUES
(1, 'AWARD_TARGET_TYPE', 'PROJECT', '科研项目', 1),
(2, 'AWARD_TARGET_TYPE', 'PAPER',   '论文',     2),
(3, 'AWARD_TARGET_TYPE', 'BOOK',    '著作',     3);


CREATE TABLE `user` (
  `id` BIGINT NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
  `password` VARCHAR(255) NOT NULL COMMENT '密码（加密）',
  `nickname` VARCHAR(50) DEFAULT NULL COMMENT '昵称',
  `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP,
  `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
)
